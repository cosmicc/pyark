<html>
<head>
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500,700&display=swap&subset=latin-ext" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/logger.css') }}"/>
<script src="{{ url_for('static', filename='js/jquery-3.3.1.min.js') }}"></script>
<script src="https://cdn.socket.io/socket.io-1.0.0.js"></script>
<script>
    $(document).ready(function(){
    //connect to the socket server.
    var socket = io.connect('http://' + document.domain + ':' + location.port + '/logstream');
    $('textarea').empty()
    socket.on('logline', function(msg) {
        //console.log(msg.line);
        $('#log').append(msg.line + '<br>');
        $('#logbox').scrollTop($('#logbox')[0].scrollHeight);
    });
    socket.on('chatline', function(msg) {
        //console.log("log line:" + msg.line);
        $('#chat').append(msg.line + '<br>');
        $('#chatbox').scrollTop($('#chatbox')[0].scrollHeight);
    });
    $('#localchat').keypress(function(e) {
    if (e.which == 13)
    {
        var lc = $('#localchat').val();
        $.post('/serverchatline', lc, function(data, status) {
            console.log(`${data} and status ${status}`)
            });
            

       $('#chat').append('[' + lcs[0].substr(1) + '] Admin - ' + msg + '<br>')
       $('#chatbox').scrollTop($('#chatbox')[0].scrollHeight);
       }
       $('#localchat').val("");
    }
});

});
</script>
</head>
<html>
    {% if current_user.has_role('admin') %}
    <body>
    <div id="toplevel" class="toplevel">
        <div id="dashboard" class="dashboard">
        </div>
    <br>
       <div id="logbox" class="logbox">
          <div id="log" class="log">
          </div>
       </div>
    <br>
       <div id="chatcombined" class="chatcombined">
          <div id="chatbox" class="chatbox">
             <div id="chat" class="chat">
             </div>
          </div>
          <div class="chatinput">  
             <input id="localchat" class="input" type="text" placeholder="@all">
          </div>   
       </div>
    </div>
    </body>
    {% endif %}
</html>
