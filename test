#!/usr/bin/python3

import subprocess

instance = '@ragnarok'

playercount = 0
cmdpipe = subprocess.Popen('arkmanager rconcmd ListPlayers %s' % instance, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)
b = cmdpipe.stdout.read().decode("utf-8")
for line in iter(b.splitlines()):
    if line.startswith('Running command') or line.startswith('"') or line.startswith(' "'):
        pass
    else:
        if not line.startswith('"No Players'):
            playercount+=1
        else:
            playercount=0
print(playercount)
