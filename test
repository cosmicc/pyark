#!/usr/bin/python3

import subprocess

def playercount(instance):
    playercount = 0
    cmdpipe = subprocess.Popen('arkmanager rconcmd ListPlayers %s' % instance, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)
    b = cmdpipe.stdout.read().decode("utf-8")
    for line in iter(b.splitlines()):
        if line.startswith('Running command') or line.startswith('"') or line.startswith(' "') or line.startswith('Error:'):
            pass
        else:
            if line.startswith('"No Players'):
                return 0
                print(line)
                playercount+=1
            else:
                playercount=0
    return playercount

print(playercount('@island'))
